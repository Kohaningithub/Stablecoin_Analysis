"0","# Add k-fold cross-validation for more reliable estimates"
"0","if(requireNamespace(""caret"", quietly = TRUE)) {"
"0","  library(caret)"
"0","  "
"0","  # For a key token like USTC"
"0","  ustc_data <- prediction_data %>% filter(token == ""USTC"")"
"0","  "
"0","  # Set up 5-fold cross-validation"
"0","  train_control <- trainControl("
"0","    method = ""cv"","
"0","    number = 5,"
"0","    verboseIter = TRUE"
"0","  )"
"0","  "
"0","  # Train models with cross-validation"
"0","  lm_cv <- train("
"0","    peg_deviation ~ prev_deviation + rolling_avg + volatility + is_weekend + period_indicator,"
"0","    data = ustc_data,"
"0","    method = ""lm"","
"0","    trControl = train_control"
"0","  )"
"0","  "
"0","  rf_cv <- train("
"0","    peg_deviation ~ prev_deviation + rolling_avg + volatility + is_weekend + period_indicator,"
"0","    data = ustc_data,"
"0","    method = ""rf"","
"0","    trControl = train_control"
"0","  )"
"0","  "
"0","  # Compare results"
"0","  print(lm_cv)"
"0","  print(rf_cv)"
"0","}"
"1","+ Fold1: intercept=TRUE"
"1"," "
"1","
"
"1","- Fold1: intercept=TRUE"
"1"," "
"1","
"
"1","+ Fold2: intercept=TRUE"
"1"," "
"1","
"
"1","- Fold2: intercept=TRUE"
"1"," "
"1","
"
"1","+ Fold3: intercept=TRUE"
"1"," "
"1","
"
"1","- Fold3: intercept=TRUE"
"1"," "
"1","
"
"1","+ Fold4: intercept=TRUE"
"1"," "
"1","
"
"1","- Fold4: intercept=TRUE"
"1"," "
"1","
"
"1","+ Fold5: intercept=TRUE"
"1"," "
"1","
"
"1","- Fold5: intercept=TRUE"
"1"," "
"1","
"
"1","Aggregating results
"
"1","Fitting"
"1"," "
"1","final model"
"1"," "
"1","on full training set
"
"1","+ Fold1: mtry=2"
"1"," "
"1","
"
"1","- Fold1: mtry=2"
"1"," "
"1","
"
"1","+ Fold1: mtry=3"
"1"," "
"1","
"
"1","- Fold1: mtry=3"
"1"," "
"1","
"
"1","+ Fold1: mtry=5"
"1"," "
"1","
"
"1","- Fold1: mtry=5"
"1"," "
"1","
"
"1","+ Fold2: mtry=2"
"1"," "
"1","
"
"1","- Fold2: mtry=2"
"1"," "
"1","
"
"1","+ Fold2: mtry=3"
"1"," "
"1","
"
"1","- Fold2: mtry=3"
"1"," "
"1","
"
"1","+ Fold2: mtry=5"
"1"," "
"1","
"
"1","- Fold2: mtry=5"
"1"," "
"1","
"
"1","+ Fold3: mtry=2"
"1"," "
"1","
"
"1","- Fold3: mtry=2"
"1"," "
"1","
"
"1","+ Fold3: mtry=3"
"1"," "
"1","
"
"1","- Fold3: mtry=3"
"1"," "
"1","
"
"1","+ Fold3: mtry=5"
"1"," "
"1","
"
"1","- Fold3: mtry=5"
"1"," "
"1","
"
"1","+ Fold4: mtry=2"
"1"," "
"1","
"
"1","- Fold4: mtry=2"
"1"," "
"1","
"
"1","+ Fold4: mtry=3"
"1"," "
"1","
"
"1","- Fold4: mtry=3"
"1"," "
"1","
"
"1","+ Fold4: mtry=5"
"1"," "
"1","
"
"1","- Fold4: mtry=5"
"1"," "
"1","
"
"1","+ Fold5: mtry=2"
"1"," "
"1","
"
"1","- Fold5: mtry=2"
"1"," "
"1","
"
"1","+ Fold5: mtry=3"
"1"," "
"1","
"
"1","- Fold5: mtry=3"
"1"," "
"1","
"
"1","+ Fold5: mtry=5"
"1"," "
"1","
"
"1","- Fold5: mtry=5"
"1"," "
"1","
"
"1","Aggregating results
"
"1","Selecting tuning parameters
"
"1","Fitting"
"1"," "
"1","mtry = 5"
"1"," "
"1","on full training set
"
"1","Linear Regression"
"1"," "
"1","

"
"1","213"
"1",""
"1"," samples"
"1","
"
"1","  5"
"1",""
"1"," predictor"
"1",""
"1","
"
"1","
"
"1","No pre-processing
"
"1","Resampling:"
"1"," "
"1","Cross-Validated (5 fold)"
"1"," "
"1","
"
"1","Summary of sample sizes:"
"1"," "
"1","169, 170, 171, 170, 172"
"1"," "
"1","
"
"1","Resampling results"
"1",":

"
"1",""
"1","  RMSE      "
"1","  Rsquared "
"1","  MAE       "
"1","
"
"1","  0.03305501"
"1","  0.9873106"
"1","  0.01116358"
"1","
"
"1","
"
"1","Tuning parameter 'intercept' was held constant at a value of TRUE"
"1","
"
"1",""
"1","Random Forest"
"1"," "
"1","

"
"1","213"
"1",""
"1"," samples"
"1","
"
"1","  5"
"1",""
"1"," predictor"
"1",""
"1","
"
"1","
"
"1","No pre-processing
"
"1","Resampling:"
"1"," "
"1","Cross-Validated (5 fold)"
"1"," "
"1","
"
"1","Summary of sample sizes:"
"1"," "
"1","170, 169, 171, 170, 172"
"1"," "
"1","
"
"1","Resampling results"
"1"," across tuning parameters"
"1",":

"
"1",""
"1","  mtry"
"1","  RMSE      "
"1","  Rsquared "
"1","  MAE        "
"1","
"
"1","  2   "
"1","  0.02342900"
"1","  0.9931669"
"1","  0.007360852"
"1","
"
"1","  3   "
"1","  0.02290800"
"1","  0.9933045"
"1","  0.007337129"
"1","
"
"1","  5   "
"1","  0.02289179"
"1","  0.9937897"
"1","  0.007551619"
"1","
"
"1","
"
"1","RMSE was used to select the optimal model using the smallest value.
"
"1","The final value used for the model was mtry = 5."
"1","
"
