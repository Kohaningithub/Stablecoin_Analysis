"0","  topics <- results$topics$model"
"0","  "
"0","  # Create topic interpretations with meaningful names"
"0","  topic_interpretations <- data.frame("
"0","    topic = paste0(""X"", 1:ncol(topics$theta)),"
"0","    interpretation = c("
"0","      ""Exchange Deposits"", ""Arbitrage Activity"", ""Liquidations"","
"0","      ""Whale Transfers"", ""Retail Panic"", ""Institutional Activity"","
"0","      ""Cross-chain Bridges"", ""DEX Swaps"", ""Lending Platforms"","
"0","      ""Staking Withdrawals"""
"0","    )[1:ncol(topics$theta)]"
"0","  )"
"0",""
"0","  # Topic prevalence over time"
"0","  topic_time <- data.frame("
"0","    date = as.Date(rownames(topics$omega)),"
"0","    topics$omega"
"0","  ) %>%"
"0","    pivot_longer("
"0","      cols = -date,"
"0","      names_to = ""topic"","
"0","      values_to = ""weight"""
"0","    ) %>%"
"0","    left_join(topic_interpretations, by = ""topic"")"
"0","  "
"0",""
"0","  # Analyze topic prevalence by period"
"0","  topic_by_period <- topic_time %>%"
"0","    mutate("
"0","      period = case_when("
"0","        date < as.Date(""2022-05-08"") ~ ""pre_crash"","
"0","        date <= as.Date(""2022-05-15"") ~ ""crash_period"","
"0","        TRUE ~ ""post_crash"""
"0","      )"
"0","    ) %>%"
"0","    group_by(period, interpretation) %>%"
"0","    summarize("
"0","      avg_weight = mean(weight, na.rm = TRUE),"
"0","      .groups = ""drop"""
"0","    ) %>%"
"0","    arrange(period, desc(avg_weight))"
"0","  "
"0",""
"0","  # Create a heatmap of topic patterns over time"
"0","  topic_time_data <- data.frame("
"0","    date = as.Date(rownames(topics$omega)),"
"0","    topics$omega"
"0","  ) %>%"
"0","    pivot_longer("
"0","      cols = -date,"
"0","      names_to = ""topic"","
"0","      values_to = ""weight"""
"0","    ) %>%"
"0","    left_join(topic_interpretations, by = ""topic"") %>%"
"0","    # Add period markers"
"0","    mutate("
"0","      period = case_when("
"0","        date < as.Date(""2022-05-08"") ~ ""Pre-Crash"","
"0","        date <= as.Date(""2022-05-15"") ~ ""Crash Period"","
"0","        TRUE ~ ""Post-Crash"""
"0","      ),"
"0","      # Format date for better display"
"0","      date_label = format(date, ""%b %d"")"
"0","    )"
"0","  "
"0","  # Create heatmap"
"0","  ggplot(topic_time_data, aes(x = date, y = interpretation, fill = weight)) +"
"0","    geom_tile() +"
"0","    scale_fill_viridis_c(name = ""Weight"", option = ""plasma"") +"
"0","    geom_vline(xintercept = as.Date(""2022-05-08""), linetype = ""dashed"", color = ""white"") +"
"0","    geom_vline(xintercept = as.Date(""2022-05-15""), linetype = ""dashed"", color = ""white"") +"
"0","    labs(title = ""Transaction Pattern Heatmap Over Time"","
"0","         subtitle = ""Darker colors indicate stronger presence of a pattern"","
"0","         x = ""Date"", y = """") +"
"0","    scale_x_date(date_breaks = ""3 days"", date_labels = ""%b %d"") +"
"0","    theme_minimal() +"
"0","    theme("
"0","      axis.text.x = element_text(angle = 45, hjust = 1),"
"0","      panel.grid = element_blank(),"
"0","      legend.position = ""right"""
"0","    )"
