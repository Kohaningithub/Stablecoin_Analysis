"0","# Ensure we have data for all periods"
"0","analyze_all_periods <- function() {"
"0","  if(is.null(results$stability$daily)) {"
"0","    cat(""No stability data available\n"")"
"0","    return(NULL)"
"0","  }"
"0","  "
"0","  # Define periods explicitly"
"0","  periods <- list("
"0","    pre_crash = c(""2022-04-01"", ""2022-05-07""),"
"0","    crash = c(""2022-05-08"", ""2022-05-15""),"
"0","    post_crash = c(""2022-05-16"", ""2022-06-15"")"
"0","  )"
"0","  "
"0","  # Create a comprehensive period summary"
"0","  period_summary <- data.frame()"
"0","  "
"0","  for(period_name in names(periods)) {"
"0","    period_dates <- periods[[period_name]]"
"0","    "
"0","    # Filter data for this period"
"0","    period_data <- results$stability$daily %>%"
"0","      filter("
"0","        date >= as.Date(period_dates[1]),"
"0","        date <= as.Date(period_dates[2])"
"0","      )"
"0","    "
"0","    # Skip if no data"
"0","    if(nrow(period_data) == 0) {"
"0","      cat(""No data available for period:"", period_name, ""\n"")"
"0","      next"
"0","    }"
"0","    "
"0","    # Calculate summary statistics"
"0","    period_stats <- period_data %>%"
"0","      group_by(token) %>%"
"0","      summarize("
"0","        period = period_name,"
"0","        observations = n(),"
"0","        mean_deviation = mean(peg_deviation, na.rm = TRUE),"
"0","        max_deviation = max(peg_deviation, na.rm = TRUE),"
"0","        min_deviation = min(peg_deviation, na.rm = TRUE),"
"0","        volatility = sd(peg_deviation, na.rm = TRUE),"
"0","        .groups = ""drop"""
"0","      )"
"0","    "
"0","    # Add to summary"
"0","    period_summary <- rbind(period_summary, period_stats)"
"0","  }"
"0","  "
"0","  # Print comprehensive summary"
"0","  knitr::kable(period_summary %>%"
"0","                arrange(period, desc(mean_deviation)),"
"0","              caption = ""Stablecoin Stability Across All Periods"")"
"0","  "
"0","  # Visualize period comparison"
"0","  ggplot(period_summary, aes(x = token, y = mean_deviation, fill = period)) +"
"0","    geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","    geom_text(aes(label = sprintf(""%.4f"", mean_deviation)),"
"0","              position = position_dodge(width = 0.9),"
"0","              vjust = -0.5, size = 3) +"
"0","    labs(title = ""Mean Peg Deviation by Period"","
"0","         x = ""Token"", y = ""Mean Deviation from $1 peg"") +"
"0","    theme_minimal() +"
"0","    theme(axis.text.x = element_text(angle = 45, hjust = 1))"
"0","  "
"0","  # Visualize max deviations"
"0","  ggplot(period_summary, aes(x = token, y = max_deviation, fill = period)) +"
"0","    geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","    geom_text(aes(label = sprintf(""%.4f"", max_deviation)),"
"0","              position = position_dodge(width = 0.9),"
"0","              vjust = -0.5, size = 3) +"
"0","    labs(title = ""Maximum Peg Deviation by Period"","
"0","         x = ""Token"", y = ""Maximum Deviation from $1 peg"") +"
"0","    theme_minimal() +"
"0","    theme(axis.text.x = element_text(angle = 45, hjust = 1))"
"0","  "
"0","  return(period_summary)"
"0","}"
"0",""
"0","# Run comprehensive period analysis"
"0","all_period_data <- analyze_all_periods()"
"1","No data available for period:"
"1"," "
"1","pre_crash"
"1"," "
"1","
"
"1","No data available for period:"
"1"," "
"1","crash"
"1"," "
"1","
"
"1","No data available for period:"
"1"," "
"1","post_crash"
"1"," "
"1","
"
"1","[1m[33mError[39m in `arrange()`:[22m
[38;5;232m[36mâ„¹[38;5;232m In argument: `..1 = period`.[39m
[1mCaused by error:[22m
[38;5;232m[33m![38;5;232m `..1` must be a vector, not a function.[39m
[90mRun `]8;;x-r-run:rlang::last_trace()rlang::last_trace()]8;;` to see where the error occurred.[39m
"
