"0","  "
"0","  # Topic prevalence over time"
"0","  topic_time <- data.frame("
"0","    date = as.Date(rownames(topics$omega)),"
"0","    topics$omega"
"0","  ) %>%"
"0","    pivot_longer("
"0","      cols = -date,"
"0","      names_to = ""topic"","
"0","      values_to = ""weight"""
"0","    ) %>%"
"0","    left_join(topic_interpretations, by = ""topic"")"
"0","  "
"0","  # Plot topic prevalence with proper labels"
"0","  #ggplot(topic_time, aes(x = date, y = weight, color = interpretation)) +"
"0","  #  geom_line() +"
"0","  #  geom_vline(xintercept = as.Date(""2022-05-08""), linetype = ""dashed"") +"
"0","  #  geom_vline(xintercept = as.Date(""2022-05-15""), linetype = ""dashed"") +"
"0","  #  labs(title = ""Transaction Pattern Topics Over Time"","
"0","  #       x = ""Date"", y = ""Topic Weight"", color = ""Topic Type"") +"
"0","  #  theme_minimal()"
"0","  "
"0","  # Analyze topic prevalence by period"
"0","  topic_by_period <- topic_time %>%"
"0","    mutate("
"0","      period = case_when("
"0","        date < as.Date(""2022-05-08"") ~ ""pre_crash"","
"0","        date <= as.Date(""2022-05-15"") ~ ""crash_period"","
"0","        TRUE ~ ""post_crash"""
"0","      )"
"0","    ) %>%"
"0","    group_by(period, interpretation) %>%"
"0","    summarize("
"0","      avg_weight = mean(weight, na.rm = TRUE),"
"0","      .groups = ""drop"""
"0","    ) %>%"
"0","    arrange(period, desc(avg_weight))"
"0","  "
"0","  # Plot topic prevalence by period"
"0","  ggplot(topic_by_period, aes(x = reorder(interpretation, avg_weight), "
"0","                             y = avg_weight, fill = period)) +"
"0","    geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","    coord_flip() +"
"0","    labs(title = ""Transaction Pattern Topics by Period"","
"0","         x = ""Topic Type"", y = ""Average Weight"", fill = ""Period"") +"
"0","    theme_minimal()"
