"0","  "
"0","  # Add period annotations"
"0","  period_data <- data.frame("
"0","    period = c(""Pre-Crash"", ""Crash Period"", ""Post-Crash""),"
"0","    start_date = as.Date(c(""2022-04-28"", ""2022-05-08"", ""2022-05-16"")),"
"0","    end_date = as.Date(c(""2022-05-07"", ""2022-05-15"", ""2022-05-25""))"
"0","  )"
"0","  "
"0","  # Create period summary heatmap"
"0","  period_summary <- topic_time_data %>%"
"0","    group_by(period, interpretation) %>%"
"0","    summarize(avg_weight = mean(weight, na.rm = TRUE), .groups = ""drop"")"
"0","  "
"0","  ggplot(period_summary, aes(x = period, y = interpretation, fill = avg_weight)) +"
"0","    geom_tile() +"
"0","    scale_fill_viridis_c(name = ""Avg Weight"", option = ""plasma"") +"
"0","    geom_text(aes(label = sprintf(""%.3f"", avg_weight)), color = ""white"", size = 3) +"
"0","    labs(title = ""Transaction Patterns by Period"","
"0","         subtitle = ""Average weight of each pattern before, during, and after the crash"","
"0","         x = """", y = """") +"
"0","    theme_minimal() +"
"0","    theme("
"0","      panel.grid = element_blank(),"
"0","      axis.text.x = element_text(face = ""bold"")"
"0","    )"
